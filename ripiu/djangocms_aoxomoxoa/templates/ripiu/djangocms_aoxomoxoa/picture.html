{% load thumbnail aoxomoxoa_filters %}

<img src="{% spaceless %}
     {% if instance.external_picture %}
       {{ instance.external_picture }}
     {% elif instance.use_no_cropping %}
       {{ instance.picture.url }}
     {% elif instance.picture %}
       {% thumbnail instance.picture thumbnail_size|get_size crop=thumbnail_size.crop upscale=thumbnail_size.upscale subject_location=instance.picture.subject_location as thumbnail %}
       {{ thumbnail.url }}
     {% endif %}{% endspaceless %}"
     {% if instance.picture.default_alt_text and not instance.attributes.alt %} alt="{{ instance.picture.default_alt_text }}"{% endif %}
     {% if not instance.picture.default_alt_text and not instance.attributes.alt %} alt=""{% endif %}
     {% if instance.caption_text %}title="{{ instance.caption_text }}"{% endif %}
     {% if instance.picture %}data-image="{% spaceless %}
       {% thumbnail instance.picture full_size|get_size crop=full_size.crop upscale=full_size.upscale subject_location=instance.picture.subject_location as full %}
       {{ full.url }}
     {% endspaceless %}"{% endif %}
     {{ instance.attributes_str }}
>
